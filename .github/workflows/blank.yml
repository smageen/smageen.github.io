name: Import apt.saurik.com Repo

on:
  workflow_dispatch:

jobs:
  import:
    runs-on: ubuntu-latest
    steps:
      - name: 📥 Download archive
        run: curl -L "https://archive.org/download/cydia_repository_archive/apt.saurik.com-(ios_main_).7z" -o "apt.saurik.com.7z"

      - name: 📂 Extract archive
        run: |
          sudo apt-get update
          sudo apt-get install -y p7zip-full binutils
          7z x apt.saurik.com.7z -oextracted

      - name: 🔍 List .deb files
        run: |
          find extracted -type f -name "*.deb" > deb_list.txt
          echo "Found $(wc -l < deb_list.txt) .deb files"

      - name: ✅ Basic .deb check
        run: |
          while read -r deb; do
            echo "Checking $deb"
            ar t "$deb" || echo "⚠️ $deb is unreadable"
          done < deb_list.txt
