name: Import apt.saurik.com Repo

on:
  workflow_dispatch:

jobs:
  import:
    runs-on: ubuntu-latest
    steps:
      - name: ðŸ§¾ Checkout repo
        uses: actions/checkout@v3

      - name: ðŸ“¥ Download archive
        run: curl -L "https://archive.org/download/cydia_repository_archive/apt.saurik.com-(ios_main_).7z" -o "apt.saurik.com.7z"

      - name: ðŸ“‚ Extract archive
        run: |
          sudo apt-get update
          sudo apt-get install -y p7zip-full
          7z x apt.saurik.com.7z -oextracted

      - name: ðŸ“¦ Copy .deb files to /repo/debs
        run: |
          mkdir -p repo/debs
          find extracted -type f -name "*.deb" -exec cp {} repo/debs/ \;

      - name: âœ… Commit and push .deb files
        run: |
          git config user.name "github-actions"
          git config user.email "github-actions@github.com"
          git add --force repo/debs/*.deb
          git commit -m "Add .deb files from apt.saurik.com"
          git push
        env:
          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}

